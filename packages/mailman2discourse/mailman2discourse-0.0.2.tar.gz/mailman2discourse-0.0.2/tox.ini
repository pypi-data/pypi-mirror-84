[tox]
envlist = flake8,py3

[testenv]
setenv =
       VIRTUAL_ENV={envdir}
passenv =
       PYTEST_ADDOPTS
allowlist_externals = env
usedevelop = True
install_command = pip install {opts} {packages}
deps = pipenv
commands_pre = env PIPENV_VERBOSITY=-1 pipenv install --ignore-pipfile --dev
commands = coverage run --source=mailman2discourse {envbindir}/py.test --log-cli-level=INFO -vvv --durations 10 {posargs:tests}
           coverage report --omit=*test*,*tox* --show-missing

[testenv:flake8]
commands = flake8 {posargs}

[flake8]
exclude = venv,.tox,dist,doc,*.egg,hack/MysqlMemberships.py
show-source = true
max_line_length = 100
