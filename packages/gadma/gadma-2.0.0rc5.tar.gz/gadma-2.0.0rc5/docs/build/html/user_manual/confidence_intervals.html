

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Confidence intervals &mdash; GADMA 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example parameters file" href="example_params_file.html" />
    <link rel="prev" title="Units of parameters" href="units.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> GADMA
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hands_on.html">Hands on</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user_manual.html">User manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="input_data.html">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="set_engine.html">Specifying an engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="set_model.html">Specifying a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_parallel.html">Repeats and parallel computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="output.html">Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting model</a></li>
<li class="toctree-l2"><a class="reference internal" href="theta.html">Theta0</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings.html">Usefull settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="extra_params_file.html">Extra parameter file</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units of parameters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Confidence intervals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-local-search-on-bootstrapped-data">Run local search on bootstrapped data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-confidence-intervals-from-table">Get Confidence Intervals from table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example_params_file.html">Example parameters file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help.html">Getting help</a></li>
</ul>
<p class="caption"><span class="caption-text">Development documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/gadma.html">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GADMA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="user_manual.html">User manual</a> &raquo;</li>
        
      <li>Confidence intervals</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user_manual/confidence_intervals.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="confidence-intervals">
<h1>Confidence intervals<a class="headerlink" href="#confidence-intervals" title="Permalink to this headline">¶</a></h1>
<p>GADMA contains special scripts for Confidence Intervals evaluation. To get CI one will need correctly bootstrapped data. If SNP’s that were used for AFS are unlinked, then usual bootstrap over them should be performed. However, if they are linked then block bootstrap should be used. It is done over the unlinked regions of genome.</p>
<p>When bootstrapped data is ready, one should run two scripts <code class="docutils literal notranslate"><span class="pre">gadma-run_ls_on_boot_data</span></code> and <code class="docutils literal notranslate"><span class="pre">gadma-get_confidence_intervals</span></code> in order to get CI. One can find example <a class="reference external" href="https://bitbucket.org/noscode/gadma_results/src/master/YRI_CEU/model_1/">here</a>.</p>
<div class="section" id="run-local-search-on-bootstrapped-data">
<h2>Run local search on bootstrapped data<a class="headerlink" href="#run-local-search-on-bootstrapped-data" title="Permalink to this headline">¶</a></h2>
<p>First script <code class="docutils literal notranslate"><span class="pre">gadma-run_ls_on_boot_data</span></code> runs local search from known optimum for initial AFS (the one that GADMA found) for each AFS from bootstrap. The usage is following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> gadma-run_ls_on_boot_data --help

<span class="go">usage: GADMA module for runs of local search on bootstrapped data.</span>
<span class="go">Is needed for calculating confidence intervals.</span>
<span class="go">       [-h] -b &lt;dir&gt; -d &lt;filename&gt; -o &lt;dir&gt; [-j N]</span>
<span class="go">       [--opt log/powell] [-p &lt;filename&gt;]</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  -b &lt;dir&gt;, --boots &lt;dir&gt;</span>
<span class="go">                        Directory where bootstrapped data is</span>
<span class="go">                        located.</span>
<span class="go">  -d &lt;filename&gt;, --dem_model &lt;filename&gt;</span>
<span class="go">                        File with demographic model. Should</span>
<span class="go">                        contain `model_func` or `generated_model`</span>
<span class="go">                        function. One can put there several extra</span>
<span class="go">                        parameters and they will be taken</span>
<span class="go">                        automatically, otherwise one will need to</span>
<span class="go">                        enter them manually. Such parameters are:</span>
<span class="go">                        1) p0 (or popt) - initial parameters values</span>
<span class="go">                        2) lower_bound - list of lower bounds for</span>
<span class="go">                        parameters values</span>
<span class="go">                        4) upper_bound - list of upper bounds for</span>
<span class="go">                        parameters values</span>
<span class="go">                        5) par_labels/param_labels - list of</span>
<span class="go">                        string names for parameters</span>
<span class="go">                        6) pts - pts for dadi (if there is no pts</span>
<span class="go">                        then moments will be run automatically).</span>
<span class="go">  -o &lt;dir&gt;, --output &lt;dir&gt;</span>
<span class="go">                        Output directory.</span>
<span class="go">  -j N, --jobs N        Number of threads for parallel run.</span>
<span class="go">  --opt log/powell      Local search algorithm, by now it can be:</span>
<span class="go">                        1) `log` - Inference.optimize_log</span>
<span class="go">                        2) `powell` - Inference.optimize_powell.</span>
<span class="go">  -p &lt;filename&gt;, --params &lt;filename&gt;</span>
<span class="go">                        Filename with parameters, should be valid</span>
<span class="go">                        python file.</span>
<span class="go">                        Parameters are presented in -d/--dem_model</span>
<span class="go">                        option description upper.</span>
</pre></div>
</div>
<p>After the run, there will be pandas table in output directory with two different extensions - <code class="docutils literal notranslate"><span class="pre">result_table.pkl</span></code> and <code class="docutils literal notranslate"><span class="pre">result_table.csv</span></code>. It contains parameters for each bootstrap. At this point of time it is possible to change its units and add new parameters with additional manipulations in Python and then run <code class="docutils literal notranslate"><span class="pre">gadma-get_confidence_intervals</span></code> to get CI.</p>
</div>
<div class="section" id="get-confidence-intervals-from-table">
<h2>Get Confidence Intervals from table<a class="headerlink" href="#get-confidence-intervals-from-table" title="Permalink to this headline">¶</a></h2>
<p>After the <code class="docutils literal notranslate"><span class="pre">gadma-run_ls_on_boot_data</span></code> the result table will be in output directory. One can change its columns due to what parameters should be used for CI. For example, it is possible to translate units from genetic and add such parameter as size of ancestral population (N_A). To do it user should write script.</p>
<p>To calculate confidence intervals:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> gadma-get_confidence_intervals --help
<span class="go">usage: GADMA module for calculating confidence</span>
<span class="go">        intervals from the result table of local</span>
<span class="go">        search runs on bootstrapped data.</span>
<span class="go">       [-h] [--log] [--tex] [--acc N] &lt;filename&gt;</span>

<span class="go">positional arguments:</span>
<span class="go">  &lt;filename&gt;  Filename (.csv or .pkl) with result from</span>
<span class="go">              local search runs on bootstrapped data.</span>
<span class="go">              Output of gadma-run_ls_on_boot_data.</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help  show this help message and exit</span>
<span class="go">  --log       If log then logarithm will be used to</span>
<span class="go">              calculate confidence intervals.</span>
<span class="go">  --tex       Tex output.</span>
<span class="go">  --acc N     Accuracy of output (dafault: 5).</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example_params_file.html" class="btn btn-neutral float-right" title="Example parameters file" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="units.html" class="btn btn-neutral float-left" title="Units of parameters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ekaterina Noskova

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>