.. _Calculation:

================================================================================
Calculation
================================================================================
Group of classes that calculates based on other models.

Common Parameters: u, name

Available models:
ACE_,
COI_

.. _ACE:

--------------------------------------------------------------------------------
ACE
--------------------------------------------------------------------------------

Group Calculation_


    Area Control Error model.

    Note: area idx is automatically retrieved from `bus`.
    
Parameters

+-------+---------------+-------------------------------+---------+------------+-----------+------------+
| Name  |    Symbol     |          Description          | Default |    Unit    |   Type    | Properties |
+=======+===============+===============================+=========+============+===========+============+
|  idx  |               | unique device idx             |         |            | DataParam |            |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  u    | :math:`u`     | connection status             | 1       | *bool*     | NumParam  |            |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  name |               | device name                   |         |            | DataParam |            |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  bus  |               | bus idx for freq. measurement |         |            | IdxParam  | mandatory  |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  bias | :math:`\beta` | bias parameter                | 1       | *MW/0.1Hz* | NumParam  | power      |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  busf |               | Optional BusFreq idx          |         |            | IdxParam  |            |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+
|  area |               |                               | 0       |            | ExtParam  |            |
+-------+---------------+-------------------------------+---------+------------+-----------+------------+

Variables

+------+-------------+---------------+--------------------+-------------+------------+
| Name |   Symbol    | Initial Value |    Description     |    Unit     | Properties |
+======+=============+===============+====================+=============+============+
|  ace | :math:`ace` |               | area control error | *MW (p.u.)* |            |
+------+-------------+---------------+--------------------+-------------+------------+
|  f   | :math:`f`   |               | Bus frequency      |             |            |
+------+-------------+---------------+--------------------+-------------+------------+

Algebraic Equations

+------+-------------+----------+---------------------------------------------------+
| Name |   Symbol    |   Type   |           RHS of Equation "0 = g(x, y)"           |
+======+=============+==========+===================================================+
|  ace | :math:`ace` | Algeb    | :math:`10 \beta \left(v^{f_{s}} - 1\right) - ace` |
+------+-------------+----------+---------------------------------------------------+
|  f   | :math:`f`   | ExtAlgeb | :math:`0`                                         |
+------+-------------+----------+---------------------------------------------------+

Discrete

+------+-------------+----------+---------------+
| Name |   Symbol    |   Type   |     Info      |
+======+=============+==========+===============+
|  fs  | :math:`f_s` | Sampling | Sampled freq. |
+------+-------------+----------+---------------+


Config Fields in [ACE]

+-------------+--------+---------+---------------------------------+-----------------+
|   Option    | Symbol |  Value  |              Info               | Accepted values |
+=============+========+=========+=================================+=================+
|  freq_model |        | BusFreq | default freq. measurement model | ('BusFreq',)    |
+-------------+--------+---------+---------------------------------+-----------------+
|  interval   |        | 4       | sampling time interval          |                 |
+-------------+--------+---------+---------------------------------+-----------------+
|  offset     |        | 0       | sampling time offset            |                 |
+-------------+--------+---------+---------------------------------+-----------------+


.. _COI:

--------------------------------------------------------------------------------
COI
--------------------------------------------------------------------------------

Group Calculation_


    Center of inertia calculation class.
    
Parameters

+-------+-----------+--------------------------+---------+--------+-----------+------------+
| Name  |  Symbol   |       Description        | Default |  Unit  |   Type    | Properties |
+=======+===========+==========================+=========+========+===========+============+
|  idx  |           | unique device idx        |         |        | DataParam |            |
+-------+-----------+--------------------------+---------+--------+-----------+------------+
|  u    | :math:`u` | connection status        | 1       | *bool* | NumParam  |            |
+-------+-----------+--------------------------+---------+--------+-----------+------------+
|  name |           | device name              |         |        | DataParam |            |
+-------+-----------+--------------------------+---------+--------+-----------+------------+
|  M    |           | Linearly stored SynGen.M | 0       |        | ExtParam  |            |
+-------+-----------+--------------------------+---------+--------+-----------+------------+

Variables

+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|    Name    |        Symbol        |       Initial Value        |                 Description                  | Unit |   Properties   |
+============+======================+============================+==============================================+======+================+
|  wgen      | :math:`\omega_{gen}` |                            | Linearly stored SynGen.omega                 |      |                |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|  agen      | :math:`\delta_{gen}` |                            | Linearly stored SynGen.delta                 |      |                |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|  omega     | :math:`\omega_{coi}` | :math:`\omega_{gen,0,avg}` | COI speed                                    |      | v_str,v_setter |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|  delta     | :math:`\delta_{coi}` | :math:`\delta_{gen,0,avg}` | COI rotor angle                              |      | v_str,v_setter |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|  omega_sub | :math:`\omega_{sub}` |                            | COI frequency contribution of each generator |      |                |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+
|  delta_sub | :math:`\delta_{sub}` |                            | COI angle contribution of each generator     |      |                |
+------------+----------------------+----------------------------+----------------------------------------------+------+----------------+

Differential Equations

+-------+----------------------+----------+----------------------------------+---------+
| Name  |        Symbol        |   Type   | RHS of Equation "T x' = f(x, y)" | T (LHS) |
+=======+======================+==========+==================================+=========+
|  wgen | :math:`\omega_{gen}` | ExtState | :math:`0`                        |         |
+-------+----------------------+----------+----------------------------------+---------+
|  agen | :math:`\delta_{gen}` | ExtState | :math:`0`                        |         |
+-------+----------------------+----------+----------------------------------+---------+

Algebraic Equations

+------------+----------------------+----------+-------------------------------+
|    Name    |        Symbol        |   Type   | RHS of Equation "0 = g(x, y)" |
+============+======================+==========+===============================+
|  omega     | :math:`\omega_{coi}` | Algeb    | :math:`- \omega_{coi}`        |
+------------+----------------------+----------+-------------------------------+
|  delta     | :math:`\delta_{coi}` | Algeb    | :math:`- \delta_{coi}`        |
+------------+----------------------+----------+-------------------------------+
|  omega_sub | :math:`\omega_{sub}` | ExtAlgeb | :math:`M_{w} \omega_{gen}`    |
+------------+----------------------+----------+-------------------------------+
|  delta_sub | :math:`\delta_{sub}` | ExtAlgeb | :math:`M_{w} \delta_{gen}`    |
+------------+----------------------+----------+-------------------------------+

Services

+------+--------------------------+------------------------------+--------------+
| Name |          Symbol          |           Equation           |     Type     |
+======+==========================+==============================+==============+
|  Mw  | :math:`M_w`              | :math:`\frac{M}{M_{tr}}`     | ConstService |
+------+--------------------------+------------------------------+--------------+
|  d0w | :math:`\delta_{gen,0,w}` | :math:`M_{w} \delta_{gen,0}` | ConstService |
+------+--------------------------+------------------------------+--------------+
|  a0w | :math:`\omega_{gen,0,w}` | :math:`M_{w} \omega_{gen,0}` | ConstService |
+------+--------------------------+------------------------------+--------------+


