

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multiple file access functions &mdash; CALCEPH  - Octave/Matlab language 3.4.7 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Error functions" href="calceph.error.html" />
    <link rel="prev" title="Library interface" href="calceph.interface.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> CALCEPH  - Octave/Matlab language
          

          
          </a>

          
            
            
              <div class="version">
                3.4.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="calceph.intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.install.mexusage.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.interface.html">Library interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Multiple file access functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#thread-notes">Thread notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-open">CalcephBin.open</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-open-array">CalcephBin.open</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-prefetch">CalcephBin.prefetch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-isthreadsafe">CalcephBin.isthreadsafe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute">CalcephBin.compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute-unit">CalcephBin.compute_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-orient-unit">CalcephBin.orient_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-rotangmom-unit">CalcephBin.rotangmom_unit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-compute-order">CalcephBin.compute_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-orient-order">CalcephBin.orient_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-rotangmom-order">CalcephBin.rotangmom_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstant">CalcephBin.getconstant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantsd">CalcephBin.getconstantsd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantvd">CalcephBin.getconstantvd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantss">CalcephBin.getconstantss</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantvs">CalcephBin.getconstantvs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantcount">CalcephBin.getconstantcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getconstantindex">CalcephBin.getconstantindex</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getfileversion">CalcephBin.getfileversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-gettimescale">CalcephBin.gettimescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-gettimespan">CalcephBin.gettimespan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getpositionrecordcount">CalcephBin.getpositionrecordcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getpositionrecordindex">CalcephBin.getpositionrecordindex</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getorientrecordcount">CalcephBin.getorientrecordcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-getorientrecordindex">CalcephBin.getorientrecordindex</a></li>
<li class="toctree-l3"><a class="reference internal" href="#menu-calceph-close">CalcephBin.close</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="calceph.error.html">Error functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.misc.html">Miscellaneous functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.naifid.html">NAIF identification numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.final.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.reportbugs.html">Reporting bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="calceph.copying.html">CALCEPH Library Copying conditions</a></li>
</ul>

            
          
    <a href="genindex.html">Index</a>
  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CALCEPH  - Octave/Matlab language</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Multiple file access functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multiple-file-access-functions">
<span id="id1"></span><h1>Multiple file access functions<a class="headerlink" href="#multiple-file-access-functions" title="Permalink to this headline">¶</a></h1>
<p>The following group of functions should be the preferred method to access to the library. They allow to access to multiple ephemeris files at the same time, even  by multiple threads.</p>
<p>When an error occurs, these functions execute error handlers according to the behavior defined by the function <a class="reference internal" href="calceph.error.html#calceph_seterrorhandler" title="calceph_seterrorhandler"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">calceph_seterrorhandler()</span></code></a>.</p>
<div class="section" id="thread-notes">
<h2>Thread notes<a class="headerlink" href="#thread-notes" title="Permalink to this headline">¶</a></h2>
<p>If the standard I/O functions such as <strong>fread</strong> are not reentrant
then the CALCEPH I/O functions using them will not be reentrant either.</p>
<p>It's not safe for two threads to call the functions with the same object of type <a class="reference internal" href="calceph.interface.html#CalcephBin" title="CalcephBin"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">CalcephBin</span></code></a> if and only if the function <a class="reference internal" href="#CalcephBin.isthreadsafe" title="CalcephBin.isthreadsafe"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.isthreadsafe()</span></code></a> returns a non-zero value.  A previous call to the function <a class="reference internal" href="#CalcephBin.prefetch" title="CalcephBin.prefetch"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.prefetch()</span></code></a> is required for the function <a class="reference internal" href="#CalcephBin.isthreadsafe" title="CalcephBin.isthreadsafe"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.isthreadsafe()</span></code></a> to return a non-zero value.</p>
<p>It's safe for two threads to access simultaneously to the same ephemeris file with two different objects of type <a class="reference internal" href="calceph.interface.html#CalcephBin" title="CalcephBin"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">CalcephBin</span></code></a>. In this case, each thread must open the same file.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The following examples, that can be found in the directory <em>examples</em> of the library sources, show the typical usage of this group of functions.</p>
<p>The example in Octave/Matlab language is <code class="file docutils literal notranslate"><span class="pre">mexmultiple.m</span></code>.</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="menu-calceph-open">
<h3>CalcephBin.open<a class="headerlink" href="#menu-calceph-open" title="Permalink to this headline">¶</a></h3>
<dl class="mat staticmethod">
<dt id="CalcephBin.open">
<em class="property">static </em><code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span> &#x2192; eph<a class="headerlink" href="#CalcephBin.open" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) -- pathname of the file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ephemeris descriptor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>CalcephBin</p>
</dd>
</dl>
</dd></dl>

<p>This function opens the file whose pathname is the string pointed to by filename, reads the two header blocks of this file
and returns an ephemeris descriptor associated to it.
This file must be compliant to the format specified by the 'original JPL binary' , 'INPOP 2.0 binary' or 'SPICE' ephemeris file.
At the moment, supported SPICE files are the following :</p>
<blockquote>
<div><ul class="simple">
<li><p>text Planetary Constants Kernel (KPL/PCK) files</p></li>
<li><p>binary PCK  (DAF/PCK) files.</p></li>
<li><p>binary SPK (DAF/SPK) files containing segments of type 1, 2, 3, 5, 8, 9, 12, 13, 17, 18, 20, 21, 102, 103 and 120.</p></li>
<li><p>meta kernel (KPL/MK) files.</p></li>
<li><p>frame kernel (KPL/FK) files. Only a basic support is provided.</p></li>
</ul>
</div></blockquote>
<p>Just after the call of <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>, the function <a class="reference internal" href="#CalcephBin.prefetch" title="CalcephBin.prefetch"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.prefetch()</span></code></a> should be called to accelerate future computations.</p>
<p>The function <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.close()</span></code> must be called to free allocated memory by this function.</p>
<p>The following example opens the ephemeris file example1.dat</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">calceph</span><span class="o">.</span><span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">)</span>

<span class="o">%</span> <span class="o">...</span>  <span class="n">computation</span> <span class="o">...</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-open-array">
<h3>CalcephBin.open<a class="headerlink" href="#menu-calceph-open-array" title="Permalink to this headline">¶</a></h3>
<dl class="mat staticmethod">
<dt>
<em class="property">static </em><code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param">array_filename</em><span class="sig-paren">)</span> &#x2192; eph</dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array_filename</strong> (<em>list</em>) -- array of pathname of the files</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ephemeris descriptor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>CalcephBin</p>
</dd>
</dl>
</dd></dl>

<p>This function opens n files whose pathnames are the string pointed to by array_filename,
reads the header blocks of these files
and returns an ephemeris descriptor associated to them.</p>
<p>The array of files must be a cell array of character vectors (see details about cellstr) , and not an string or character arrays.</p>
<p>These files must have the same type (e.g., all files are SPICE files or original JPL files).
This file must be compliant to the format specified by the  'original JPL binary' , 'INPOP 2.0 or 3.0 binary' or 'SPICE' ephemeris file.
At the moment, supported SPICE files are the following :</p>
<blockquote>
<div><ul class="simple">
<li><p>text Planetary Constants Kernel (KPL/PCK) files</p></li>
<li><p>binary PCK  (DAF/PCK) files.</p></li>
<li><p>binary SPK (DAF/SPK) files containing segments of type 1, 2, 3, 5, 8, 9, 12, 13, 17, 18, 20, 21, 102, 103 and 120.</p></li>
<li><p>meta kernel (KPL/MK) files.</p></li>
<li><p>frame kernel (KPL/FK) files. Only a basic support is provided.</p></li>
</ul>
</div></blockquote>
<p>Just after the call of <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>, the function <a class="reference internal" href="#CalcephBin.prefetch" title="CalcephBin.prefetch"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.prefetch()</span></code></a> should be called to accelerate future computations.</p>
<p>The function <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.close()</span></code> must be called to free allocated memory by this function.</p>
<p>The following example opens the ephemeris file example1.bsp and example1.tpc</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">cellstr</span><span class="p">({</span><span class="s1">&#39;example1.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;example1.tpc&#39;</span><span class="p">}))</span>

<span class="o">%</span> <span class="o">...</span> <span class="n">computation</span> <span class="o">...</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-prefetch">
<h3>CalcephBin.prefetch<a class="headerlink" href="#menu-calceph-prefetch" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.prefetch">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">prefetch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.prefetch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function prefetches to the main memory all files associated to the ephemeris descriptor.
This prefetching operation will accelerate the further computations performed with <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>, <a class="reference internal" href="#CalcephBin.compute_unit" title="CalcephBin.compute_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute_unit()</span></code></a>,  <a class="reference internal" href="#CalcephBin.compute_order" title="CalcephBin.compute_order"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute_order()</span></code></a>, <a class="reference internal" href="#CalcephBin.orient_unit" title="CalcephBin.orient_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.orient_unit()</span></code></a>, ... .</p>
<p>It requires that the file is smaller than the main memory.
If multiple threads (e.g. threads of openMP or Posix Pthreads) prefetch the data for the same ephemeris file,
the used memory will remain the same as if the prefetch operation was done by a single thread if and if the
endianess of the file is the same as the computer and if the operating system, such as Linux, MacOS X other unix, supports the function mmap.</p>
</div>
<div class="section" id="menu-calceph-isthreadsafe">
<h3>CalcephBin.isthreadsafe<a class="headerlink" href="#menu-calceph-isthreadsafe" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.isthreadsafe">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">isthreadsafe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.isthreadsafe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>This function returns 1 if multiple threads can access the same ephemeris ephemeris descriptor, otherwise 0.</p>
<p>A previous call to the function <a class="reference internal" href="#CalcephBin.prefetch" title="CalcephBin.prefetch"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.prefetch()</span></code></a> is required, and the library should becompiled with <strong>--enable-thread=yes</strong> on Unix-like operating system,  for the function <a class="reference internal" href="#CalcephBin.isthreadsafe" title="CalcephBin.isthreadsafe"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.isthreadsafe()</span></code></a> to return a non-zero value. If the file is not encoded with the same endian as the current hardware, then function may return 0.</p>
<p>If this function returns 1, severals threads may use the same ephemeris descriptor for the computational functions <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>, .... It allows to use the same object for parallel loops.</p>
</div>
<div class="section" id="menu-calceph-compute">
<h3>CalcephBin.compute<a class="headerlink" href="#menu-calceph-compute" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.compute">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">compute</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">center</em><span class="sig-paren">)</span> &#x2192; PV<a class="headerlink" href="#CalcephBin.compute" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body or reference point whose coordinates are required (see the list, below).</p></li>
<li><p><strong>center</strong> (<em>int</em>) -- The origin of the coordinate system (see the list, below). If <em>target</em> is 14, 15, 16 or 17 (nutation, libration, TT-TDB or TCG-TCB), <em>center</em> must be <em>0</em>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the target value, an array to receive the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot), or a time scale transformation value, or the angles of the librations of the Moon and their derivatives, or the nutation angles and their derivatives.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates a single object, usually the position and velocity of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.</p>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is <em>TT-TDB</em>, only the first element of this array will get the result. The time scale transformation TT-TDB is expressed in seconds.</p></li>
<li><p>If the target is <em>TCG-TCB</em>, only the first element of this array will get the result. The time scale transformation TCG-TCB is expressed in seconds.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon and their derivatives. The angles of the librations of the Moon are expressed in radians and their derivatives are expressed in radians per day.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their derivatives. The nutation angles are expressed in radians and their derivatives are expressed in radians per day.</p></li>
<li><p>Otherwise the returned values is the cartesian position (x,y,z), expressed in Astronomical Unit (au), and the velocity (xdot, ydot, zdot), expressed in Astronomical Unit per day (au/day).</p></li>
</ul>
</div></blockquote>
<p>To get the best numerical precision for the interpolation, the time is splitted in two floating-point numbers. The argument <em>JD0</em> should be an integer and <em>time</em> should be a fraction of the day. But you may call this function with <em>time=0</em> and <em>JD0</em>, the desired time, if you don't take care about numerical precision.</p>
<p>The possible values for <em>target</em> and <em>center</em> are  :</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 59%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Mercury Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Venus Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Earth</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Mars Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Jupiter Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Saturn Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Uranus Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Neptune Barycenter</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Pluto Barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Moon</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>Sun</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Solar Sytem barycenter</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Earth-moon barycenter</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Nutation angles</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Librations</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>TT-TDB</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>TCG-TCB</p></td>
</tr>
<tr class="row-odd"><td><p>asteroid number + CALCEPH_ASTEROID</p></td>
<td><p>asteroid</p></td>
</tr>
</tbody>
</table>
<p>These accepted values by this function are the same as the value for the JPL function <em>PLEPH</em>, except for the values <em>TT-TDB</em>, <em>TCG-TCB</em> and asteroids.</p>
<p>For example, the value &quot;CALCEPH_ASTEROID+4&quot; for target or center specifies the asteroid Vesta.</p>
<p>The following example prints the heliocentric coordinates of Mars at time=2442457.5 and at 2442457.9</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2442457</span>
<span class="n">dt1</span><span class="o">=</span><span class="mf">0.5E0</span>
<span class="n">dt2</span><span class="o">=</span><span class="mf">0.9E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>

<span class="n">disp</span><span class="p">(</span><span class="s1">&#39;heliocentric coordinates of Mars&#39;</span><span class="p">)</span>
<span class="n">PV1</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">disp</span><span class="p">(</span><span class="s1">&#39;heliocentric coordinates of Mars&#39;</span><span class="p">)</span>
<span class="n">PV2</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-compute-unit">
<h3>CalcephBin.compute_unit<a class="headerlink" href="#menu-calceph-compute-unit" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.compute_unit">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">compute_unit</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">center</em>, <em class="sig-param">unit</em><span class="sig-paren">)</span> &#x2192; PV<a class="headerlink" href="#CalcephBin.compute_unit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body or reference point whose coordinates are required. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>center</strong> (<em>int</em>) -- The origin of the coordinate system. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target and the center (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit doesnot contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target and the center (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the target value, an array to receive the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot), or a time scale transformation value, or the angles of the librations of the Moon and their derivatives, or the nutation angles and their derivatives.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function is similar to the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>, except that the units of the output are specified.</p>
<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates a single object, usually the position and velocity of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is the time scale transformation TT-TDB, only the first element of this array will get the result.</p></li>
<li><p>If the target is the time scale transformation  <em>TCG-TCB</em>, only the first element of this array will get the result.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon  and their derivatives.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their derivatives.</p></li>
<li><p>Otherwise the returned value is the cartesian position (x,y,z) and the velocity (xdot, ydot, zdot).</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The position and velocity are expressed in Astronomical Unit (au) if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_AU</span></code>.</p></li>
<li><p>The position and velocity are expressed in kilometers if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_KM</span></code>.</p></li>
<li><p>The velocity, TT-TDB, TCG-TCB, the derivatives of the angles of the nutation, or the derivatives of the librations of the Moon or are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The velocity, TT-TDB, TCG-TCB, the derivatives of the angles of the nutation, or the derivatives of the librations of the Moon are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
<li><p>The angles of the librations of the Moon or the nutation angles are expressed in radians if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_RAD</span></code>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the position and velocities expressed in kilometers and kilometers/seconds, the unit must be set to <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_KM</span></code> + <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p>
<p>The following example prints the heliocentric coordinates of Mars  at time=2442457.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2442457</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>

<span class="n">disp</span><span class="p">(</span><span class="s1">&#39;heliocentric coordinates of Mars&#39;</span><span class="p">)</span>
<span class="n">PV1</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute_unit</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_KM</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="p">)</span>


<span class="n">disp</span><span class="p">(</span><span class="s1">&#39;heliocentric coordinates of Mars&#39;</span><span class="p">)</span>
<span class="n">PV2</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute_unit</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">MARS_BARYCENTER</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">SUN</span><span class="p">,</span>
                        <span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_KM</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-orient-unit">
<h3>CalcephBin.orient_unit<a class="headerlink" href="#menu-calceph-orient-unit" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.orient_unit">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">orient_unit</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">unit</em><span class="sig-paren">)</span> &#x2192; PV<a class="headerlink" href="#CalcephBin.orient_unit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array to receive the euler angles, or nutation angles, and their derivatives for the orientation of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates the orientation of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PV</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If <em>unit</em> contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_NUTATIONANGLES</span></code>,  the array contains the nutation angles and their derivatives for the orientation of the body. At the present moment, only the nutation for the earth are supported in the original DE files.</p></li>
<li><p>If <em>unit</em> contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_EULERANGLES</span></code>, or doesnot contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_NUTATIONANGLES</span></code>, the array contains the euler angles and their derivatives for the orientation of the body.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The derivatives of the angles are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The derivatives of the angles are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
<li><p>The angles and their derivatives are expressed in radians if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_RAD</span></code>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the nutation angles of the Earth and their derivatives expressed in radian and radian/seconds using the NAIF identification numbering system, the target must be set to NAIFID_EARTH and the unit must be set to <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_NUTATIONANGLES</span></code> + <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_RAD</span></code> + <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p>
<p>The following example prints the angles of libration of the Moon at time=2442457.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2442457</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>

<span class="n">PV</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">orient_unit</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">MOON</span><span class="p">,</span>
                      <span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_RAD</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-rotangmom-unit">
<h3>CalcephBin.rotangmom_unit<a class="headerlink" href="#menu-calceph-rotangmom-unit" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt>
<code class="sig-prename descclassname">calcephpy.CalcephBin.</code><code class="sig-name descname">rotangmom_unit</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">unit</em><span class="sig-paren">)</span> &#x2192; PV</dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array to receive the angular momentum due to its rotation, divided by the product of the mass and of the square of the radius, and the derivatives, of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates the angular momentum vector due to the rotation of the body, divided by the product of the mass <img class="math" src="_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/> and of the square of the radius <img class="math" src="_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/>, of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PV</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>. The angular momentum <img class="math" src="_images/math/19eef1966f7c545af3ac8c0fa486974d873e3c65.png" alt="L"/> , due to the rotation of the body, is defined as the product of the inertia matrix <img class="math" src="_images/math/015755a22b6219b345c36a9a47b091dc56007486.png" alt="I"/> by the angular velocity vector <img class="math" src="_images/math/50933ea18d380a4a0a04d410f57212d1bc68e583.png" alt="{\omega}"/>. So the returned value is <img class="math" src="_images/math/24b9ed6eb21d19417c11c253db92cbb9cd09cf83.png" alt="L/(mR^2)=(I\omega)/(mR^2)"/>
The output values are expressed in the units specified by <em>unit</em>.</p>
<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The values stored in the  array <em>PV</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The angular momentum and its derivative are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The angular momentum and its derivative are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
</ul>
</div></blockquote>
<p>The following example prints the angular momentum, due to its rotation, for the Earth at time=2451419.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2451419</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example2_rotangmom.dat&#39;</span><span class="p">);</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">rotangmom_unit</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">EARTH</span><span class="p">,</span>
                      <span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-compute-order">
<h3>CalcephBin.compute_order<a class="headerlink" href="#menu-calceph-compute-order" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.compute_order">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">compute_order</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">center</em>, <em class="sig-param">unit</em>, <em class="sig-param">order</em><span class="sig-paren">)</span> &#x2192; PVAJ<a class="headerlink" href="#CalcephBin.compute_order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body or reference point whose coordinates are required. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>center</strong> (<em>int</em>) -- The origin of the coordinate system. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PVAJ.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target and the center (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit doesnot contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target and the center (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong> (<em>int</em>) -- <p>The order of derivatives</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the position is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the position and velocity are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the position, velocity and acceleration are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the position, velocity and acceleration and jerk are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#CalcephBin.compute_order" title="CalcephBin.compute_order"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute_order()</span></code></a> is the same as <a class="reference internal" href="#CalcephBin.compute_unit" title="CalcephBin.compute_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute_unit()</span></code></a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Depending on the target value, an array to receive the cartesian position (x,y,z), the velocity (xdot, ydot, zdot), the acceleration and the jerk, or a time scale transformation value, or the angles of the librations of the Moon and their successive derivatives, or the nutation angles and their successive derivatives.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function is similar to the function <a class="reference internal" href="#CalcephBin.compute_unit" title="CalcephBin.compute_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates a single object, usually the position and their derivatives of one body (<em>target</em>) relative to another (<em>center</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.
The order of the derivatives are specified by <em>order</em>. The output values are expressed in the units specified by <em>unit</em>.</p>
<p>The returned array <em>PVAJ</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If the target is the time scale transformation TT-TDB, only the first elements of each component will get the result.</p></li>
<li><p>If the target is the time scale transformation  <em>TCG-TCB</em>, only the first elements of each component will get the result.</p></li>
<li><p>If the target is <em>Librations</em>, the array contains the angles of the librations of the Moon  and their successive derivatives.</p></li>
<li><p>If the target is <em>Nutations</em>, the array contains the nutation angles and their successive derivatives.</p></li>
<li><p>Otherwise the returned value is the cartesian position (x,y,z), the velocity (xdot, ydot, zdot), the jerk and the acceleration.</p></li>
</ul>
</div></blockquote>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the position (x,y,z) and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the velocity  (dx/dt,dy/dt,dz/dt) and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the acceleration (d^2x/dt^2,d^2y/dt^2,d^2z/dt^2) and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12] contain the jerk (d^3x/dt^3,d^3y/dt^3,d^3z/dt^3) and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The position, velocity, acceleration and jerk are expressed in Astronomical Unit (au) if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_AU</span></code>.</p></li>
<li><p>The position, velocity, acceleration and jerk are expressed in kilometers if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_KM</span></code>.</p></li>
<li><p>The velocity, acceleration, jerk, TT-TDB, TCG-TCB or the derivatives of the angles of the librations of the Moon are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The velocity, acceleration, jerk, TT-TDB, TCG-TCB or the derivatives of the angles of the librations of the Moon are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
<li><p>The angles of the librations of the Moon are expressed in radians if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_RAD</span></code>.</p></li>
</ul>
</div></blockquote>
<p>For example, to get the positions, velocities, accelerations and jerks expressed in kilometers and kilometers/seconds, the unit must be set to <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_KM</span></code> + <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The following example prints the heliocentric coordinates of Mars at time=2442457.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2442457</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>

<span class="o">%</span> <span class="n">compute</span> <span class="n">only</span> <span class="n">the</span> <span class="n">heliocentric</span> <span class="n">position</span> <span class="n">of</span> <span class="n">Mars</span> <span class="ow">in</span> <span class="n">km</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute_order</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">MARS_BARYCENTER</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">SUN</span><span class="p">,</span>
                        <span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_KM</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="o">%</span> <span class="n">compute</span> <span class="n">positions</span><span class="p">,</span> <span class="n">velocities</span><span class="p">,</span> <span class="n">accelerations</span> <span class="ow">and</span> <span class="n">jerks</span> <span class="n">of</span> <span class="n">Mars</span> <span class="ow">in</span> <span class="n">km</span> <span class="ow">and</span> <span class="n">seconds</span>
<span class="n">PVAJ</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">compute_order</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">MARS_BARYCENTER</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">SUN</span><span class="p">,</span>
                        <span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_KM</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-orient-order">
<h3>CalcephBin.orient_order<a class="headerlink" href="#menu-calceph-orient-order" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.orient_order">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">orient_order</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">unit</em>, <em class="sig-param">order</em><span class="sig-paren">)</span> &#x2192; PVAJ<a class="headerlink" href="#CalcephBin.orient_order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong> (<em>int</em>) -- <p>The order of derivatives.</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the angles is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the angles and the first derivative are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the angles and the first and second derivatives are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the angles and the first, second and third derivatives  are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#CalcephBin.orient_order" title="CalcephBin.orient_order"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.orient_order()</span></code></a> is the same as <a class="reference internal" href="#CalcephBin.orient_unit" title="CalcephBin.orient_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.orient_unit()</span></code></a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array to receive the euler angles, or nutation angles, and their derivatives for the orientation of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function is similar to the function <a class="reference internal" href="#CalcephBin.orient_unit" title="CalcephBin.orient_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.orient_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates the orientation of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>.
The order of the derivatives are specified by <em>order</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PVAJ</em> has the following properties</p>
<blockquote>
<div><ul class="simple">
<li><p>If <em>unit</em> contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_NUTATIONANGLES</span></code>, the array contains the nutation angles and their successive derivatives for the orientation of the body. At the present moment, only the nutation for the earth are supported in the original DE files.</p></li>
<li><p>If <em>unit</em> contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_EULERANGLES</span></code>, or doesnot contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">OUTPUT_NUTATIONANGLES</span></code>, the array contains the euler angles and their successive derivatives for the orientation of the body.</p></li>
</ul>
</div></blockquote>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the angles  and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the first derivative and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the second derivative and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12]  contain the third derivative and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The derivatives of the angles are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The derivatives of the angles are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
<li><p>The angles and their derivatives are expressed in radians if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_RAD</span></code>.</p></li>
</ul>
</div></blockquote>
<p>The following example prints only the angles of libration of the Moon at time=2442457.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2442457</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">orient_order</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">MOON</span><span class="p">,</span>
                      <span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_RAD</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-rotangmom-order">
<h3>CalcephBin.rotangmom_order<a class="headerlink" href="#menu-calceph-rotangmom-order" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.rotangmom_order">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">rotangmom_order</code><span class="sig-paren">(</span><em class="sig-param">JD0</em>, <em class="sig-param">time</em>, <em class="sig-param">target</em>, <em class="sig-param">unit</em>, <em class="sig-param">order</em><span class="sig-paren">)</span> &#x2192; PVAJ<a class="headerlink" href="#CalcephBin.rotangmom_order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>JD0</strong> (<em>double</em>) -- Integer part of the Julian date</p></li>
<li><p><strong>time</strong> (<em>double</em>) -- Fraction part of the Julian date</p></li>
<li><p><strong>target</strong> (<em>int</em>) -- The body whose orientations are requested. The numbering system depends on the parameter unit.</p></li>
<li><p><strong>unit</strong> (<em>int</em>) -- <div class="line-block">
<div class="line">The units of PV.</div>
<div class="line">This integer is a sum of some unit constants (CALCEPH_UNIT_???) and/or the constant <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>.</div>
<div class="line">If the unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the NAIF identification numbering system is used for the target (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).</div>
<div class="line">If the unit does not contain <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">USE_NAIFID</span></code>, the old number system is used for the target (see the list in the function <a class="reference internal" href="#CalcephBin.compute" title="CalcephBin.compute"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.compute()</span></code></a>).</div>
</div>
</p></li>
<li><p><strong>order</strong> (<em>int</em>) -- <p>The order of derivatives.</p>
<blockquote>
<div><ul>
<li><p>= 0 , only the angular momentum is computed. The first three numbers of PVAJ are valid for the results.</p></li>
<li><p>= 1 , only the angular momentum and the first derivative are computed. The first six numbers of PVAJ are valid for the results.</p></li>
<li><p>= 2 , only the angular momentum and the first and second derivatives are computed. The first nine numbers of PVAJ are valid for the results.</p></li>
<li><p>= 3 , the angular momentum and the first, second and third derivatives  are computed. The first twelve numbers of PVAJ are valid for the results.</p></li>
</ul>
</div></blockquote>
<p>If order equals to 1, the behavior of <a class="reference internal" href="#CalcephBin.rotangmom_order" title="CalcephBin.rotangmom_order"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.rotangmom_order()</span></code></a> is the same as <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.rotangmom_unit()</span></code>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array to receive the angular momentum due to its rotation, divided by the product of the mass and of the square of the radius, and their different order of the derivatives, of the body.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p>This function is similar to the function <a class="reference internal" href="#CalcephBin.orient_unit" title="CalcephBin.orient_unit"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.orient_unit()</span></code></a>, except that the order of the computed derivatives is specified.</p>
<p>This function reads, if needed, in the ephemeris file <em>self</em> and interpolates the angular momentum vector due to the rotation of the body, divided by the product of the mass <img class="math" src="_images/math/e9bc7da808d33a16a8347f27a519bd067186aa66.png" alt="m"/> and of the square of the radius <img class="math" src="_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/>, of a single body (<em>target</em>) for the time <em>JD0+time</em> and stores the results to <em>PVAJ</em>. The angular momentum <img class="math" src="_images/math/19eef1966f7c545af3ac8c0fa486974d873e3c65.png" alt="L"/> , due to the rotation of the body, is defined as the product of the inertia matrix <img class="math" src="_images/math/015755a22b6219b345c36a9a47b091dc56007486.png" alt="I"/> by the angular velocity vector <img class="math" src="_images/math/50933ea18d380a4a0a04d410f57212d1bc68e583.png" alt="{\omega}"/>. So the returned value is <img class="math" src="_images/math/24b9ed6eb21d19417c11c253db92cbb9cd09cf83.png" alt="L/(mR^2)=(I\omega)/(mR^2)"/>
The order of the derivatives are specified by <em>order</em>. The ephemeris file <em>self</em> must have been previously opened with the function <a class="reference internal" href="#CalcephBin.open" title="CalcephBin.open"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.open()</span></code></a>.
The output values are expressed in the units specified by <em>unit</em>.</p>
<p><em>JD0</em> and <em>time</em> could be arrays of double-precision floating-point values.</p>
<p>This function checks the units if invalid combinations of units are given to the function.</p>
<p>The returned array <em>PVAJ</em> must be large enough to store the results.</p>
<blockquote>
<div><ul class="simple">
<li><p>PVAJ[1:3] contain the angular momentum  and is always valid.</p></li>
<li><p>PVAJ[4:6] contain the first derivative and is only valid if <em>order</em> is greater or equal to 1.</p></li>
<li><p>PVAJ[7:9] contain the second derivative and is only valid if <em>order</em> is greater or equal to 2.</p></li>
<li><p>PVAJ[10:12] contain the third derivative and is only valid if <em>order</em> is equal to 3.</p></li>
</ul>
</div></blockquote>
<p>The values stored in the  array <em>PVAJ</em> are expressed in the following units</p>
<blockquote>
<div><ul class="simple">
<li><p>The angular momentum and its derivatives are expressed in days if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_DAY</span></code>.</p></li>
<li><p>The angular momentum and its derivatives are expressed in seconds if unit contains <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">UNIT_SEC</span></code>.</p></li>
</ul>
</div></blockquote>
<p>The following example prints only the angular momentum, due to its rotation, of the Earth at time=2451419.5</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jd0</span><span class="o">=</span><span class="mi">2451419</span>
<span class="n">dt</span><span class="o">=</span><span class="mf">0.5E0</span>

<span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example2_rotangmom.dat&#39;</span><span class="p">)</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">rotangmom_order</span><span class="p">(</span><span class="n">jd0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">NaifId</span><span class="o">.</span><span class="n">EARTH</span><span class="p">,</span>
                      <span class="n">Constants</span><span class="o">.</span><span class="n">USE_NAIFID</span><span class="o">+</span><span class="n">Constants</span><span class="o">.</span><span class="n">UNIT_SEC</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstant">
<h3>CalcephBin.getconstant<a class="headerlink" href="#menu-calceph-getconstant" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstant">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstant</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span> &#x2192; value<a class="headerlink" href="#CalcephBin.getconstant" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- name of the constant</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>first value of the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the value associated to the constant <em>name</em> in the header of the ephemeris file <em>self</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values.</p>
<p>This function is the same function as <a class="reference internal" href="#CalcephBin.getconstantsd" title="CalcephBin.getconstantsd"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getconstantsd()</span></code></a>.</p>
<p>The following example prints the value of the astronomical unit stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">AU</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstant</span><span class="p">(</span><span class="s1">&#39;AU&#39;</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantsd">
<h3>CalcephBin.getconstantsd<a class="headerlink" href="#menu-calceph-getconstantsd" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantsd">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantsd</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span> &#x2192; value<a class="headerlink" href="#CalcephBin.getconstantsd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- name of the constant</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>first value of the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as a floating-point number, the value associated to the constant <em>name</em> in the header of the ephemeris file <em>self</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values. The value must be a floating-point or integer number, otherwise an error is reported.</p>
<p>This function is the same function as <a class="reference internal" href="#CalcephBin.getconstant" title="CalcephBin.getconstant"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getconstant()</span></code></a>.</p>
<p>The following example prints the value of the astronomical unit stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">AU</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantsd</span><span class="p">(</span><span class="s1">&#39;AU&#39;</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantvd">
<h3>CalcephBin.getconstantvd<a class="headerlink" href="#menu-calceph-getconstantvd" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantvd">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantvd</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span> &#x2192; arrayvalue<a class="headerlink" href="#CalcephBin.getconstantvd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- name of the constant</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of values for the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vector</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as floating-point numbers, all values associated to the constant <em>name</em> in the header of the ephemeris file <em>self</em>.</p>
<p>The values must be  floating-point or integer numbers, otherwise an error is reported.</p>
<p>The following example prints the body radii of the earth stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">radii</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantvd</span><span class="p">(</span><span class="s1">&#39;BODY399_RADII&#39;</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantss">
<h3>CalcephBin.getconstantss<a class="headerlink" href="#menu-calceph-getconstantss" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantss">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantss</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span> &#x2192; value<a class="headerlink" href="#CalcephBin.getconstantss" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- name of the constant</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>first value of the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as a string of character, the value associated to the constant <em>name</em> in the header of the ephemeris file <em>self</em>. Only the first value is returned if multiple values are associated to a constant, such as a list of values. The value must be a string, otherwise an error is reported.</p>
<p>The following example prints the value of the unit stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">UNIT</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantss</span><span class="p">(</span><span class="s1">&#39;UNIT&#39;</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantvs">
<h3>CalcephBin.getconstantvs<a class="headerlink" href="#menu-calceph-getconstantvs" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantvs">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantvs</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span> &#x2192; arrayvalue<a class="headerlink" href="#CalcephBin.getconstantvs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) -- name of the constant</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of values for the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cell array of character vectors</p>
</dd>
</dl>
</dd></dl>

<p>This function returns, as strings of characters, all values associated to the constant <em>name</em> in the header of the ephemeris file <em>self</em>.</p>
<p>The values must be strings, otherwise an error is reported.</p>
<p>The following example prints the units of the mission stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">mission_units</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantvs</span><span class="p">(</span><span class="s1">&#39;MISSION_UNITS&#39;</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantcount">
<h3>CalcephBin.getconstantcount<a class="headerlink" href="#menu-calceph-getconstantcount" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantcount">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.getconstantcount" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of constants</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of constants available in the header of the ephemeris file <em>self</em>.</p>
<p>The following example prints the number of available constants stored in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantcount</span><span class="p">()</span>
<span class="n">printf</span><span class="p">(</span><span class="s1">&#39;number of constants=</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getconstantindex">
<h3>CalcephBin.getconstantindex<a class="headerlink" href="#menu-calceph-getconstantindex" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getconstantindex">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getconstantindex</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span> &#x2192; name, value<a class="headerlink" href="#CalcephBin.getconstantindex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) -- index of the constant, between 1 and <a class="reference internal" href="#CalcephBin.getconstantcount" title="CalcephBin.getconstantcount"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getconstantcount()</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>name of the constant, first value of the constant</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str, double</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the name and its value of the constant available at the specified index in the header of the ephemeris file <em>self</em>. The value of <em>index</em> must be between 1 and <a class="reference internal" href="#CalcephBin.getconstantcount" title="CalcephBin.getconstantcount"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getconstantcount()</span></code></a>.</p>
<p>Only the first value is returned if multiple values are associated to a constant, such as a list of values.</p>
<p>The following example displays the name of the constants, stored in the ephemeris file, and their values</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantcount</span><span class="p">()</span>
<span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="p">[</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="p">]</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getconstantindex</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="n">end</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getfileversion">
<h3>CalcephBin.getfileversion<a class="headerlink" href="#menu-calceph-getfileversion" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getfileversion">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getfileversion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.getfileversion" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>version of the ephemeris file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the version of the ephemeris file, as a string. For example, the argument version will contain 'INPOP10B', 'EPM2017' or 'DE405', ... .</p>
<p>If the file is an original JPL binary planetary ephemeris, then the version of the file can always be determined.
If the file is a spice kernel, the version of the file is retrieved from the constant <em>INPOP_PCK_VERSION</em>, <em>EPM_PCK_VERSION</em>, or <em>PCK_VERSION</em>.</p>
<p>The following example prints the version of the ephemeris file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">version</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getfileversion</span><span class="p">()</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-gettimescale">
<h3>CalcephBin.gettimescale<a class="headerlink" href="#menu-calceph-gettimescale" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.gettimescale">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">gettimescale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.gettimescale" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>time scale of the ephemeris file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="simple">
<dt>This function returns the timescale of the ephemeris file <em>self</em> :</dt><dd><ul class="simple">
<li><p>1 if the quantities of all bodies are expressed in the TDB time scale.</p></li>
<li><p>2 if the quantities of all bodies are expressed in the TCB time scale.</p></li>
</ul>
</dd>
</dl>
<p>The following example prints the time scale available in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">timescale</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">gettimescale</span><span class="p">()</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-gettimespan">
<h3>CalcephBin.gettimespan<a class="headerlink" href="#menu-calceph-gettimespan" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.gettimespan">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">gettimespan</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; firsttime, lasttime, continuous<a class="headerlink" href="#CalcephBin.gettimespan" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>first and last available time, availability of the quantities of the bodies over the time span</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>double, double, int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the first and last time available in the ephemeris file <em>self</em>. The Julian date for the first and last time are expressed in the time scale returned by  <a class="reference internal" href="#CalcephBin.gettimescale" title="CalcephBin.gettimescale"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.gettimescale()</span></code></a>
.</p>
<p>It returns the following value in the parameter <em>continuous</em> :</p>
<blockquote>
<div><ul class="simple">
<li><p>1 if the quantities of all bodies are available for any time between the first and last time.</p></li>
<li><p>2 if the quantities of some bodies are available on discontinuous time intervals between the first and last time.</p></li>
<li><p>3 if the quantities of each body are available on a continuous time interval between the first and last time, but not available for any time between the first and last time.</p></li>
</ul>
</div></blockquote>
<p>The following example prints the first and last time available in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">firsttime</span><span class="p">,</span> <span class="n">lasttime</span><span class="p">,</span> <span class="n">continuous</span> <span class="p">]</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">gettimespan</span><span class="p">()</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getpositionrecordcount">
<h3>CalcephBin.getpositionrecordcount<a class="headerlink" href="#menu-calceph-getpositionrecordcount" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt>
<code class="sig-prename descclassname">calcephpy.CalcephBin.</code><code class="sig-name descname">getpositionrecordcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of position's records</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of position's records available in the ephemeris file <em>self</em>.
Usually, the number of records is equal to the number of bodies in the ephemeris file if the timespan is continuous.
If the timespan is discontinuous for the target and center bodies,
then each different timespan is counted as a different record.
If the ephemeris file contain timescale transformations' records, such as <em>TT-TDB</em> or <em>TCG-TCB</em>, then these records are included in the returned value.</p>
<p>The following example prints the number of position's records available in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getpositionrecordcount</span><span class="p">()</span>
<span class="n">printf</span><span class="p">(</span><span class="s1">&#39;number of position&#39;&#39;s record=</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getpositionrecordindex">
<h3>CalcephBin.getpositionrecordindex<a class="headerlink" href="#menu-calceph-getpositionrecordindex" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getpositionrecordindex">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getpositionrecordindex</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span> &#x2192; target, center, firsttime, lasttime, frame<a class="headerlink" href="#CalcephBin.getpositionrecordindex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) -- index of the position's record, between 1 and <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getpositionrecordcount()</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><div class="line-block">
<div class="line"><strong>target</strong> : the target body</div>
<div class="line"><strong>center</strong> : the origin body</div>
<div class="line"><strong>firsttime</strong> : julian date of the first time</div>
<div class="line"><strong>lasttime</strong> : julian date of the last time</div>
<div class="line"><strong>frame</strong>  : reference frame (see the list, below)</div>
</div>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int, int, double, double, int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target and origin bodies, the first and last time, and the reference frame available at the specified index for the position's records of the ephemeris file <em>self</em>.
The NAIF identification numbering system is used for the target and center integers (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#CalcephBin.gettimescale" title="CalcephBin.gettimescale"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>The following example displays the position's records stored in the ephemeris file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getpositionrecordcount</span><span class="p">()</span>
<span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="p">[</span><span class="n">itarget</span><span class="p">,</span> <span class="n">icenter</span><span class="p">,</span> <span class="n">firsttime</span><span class="p">,</span> <span class="n">lasttime</span><span class="p">,</span> <span class="n">iframe</span><span class="p">]</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getpositionrecordindex</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="n">end</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getorientrecordcount">
<h3>CalcephBin.getorientrecordcount<a class="headerlink" href="#menu-calceph-getorientrecordcount" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getorientrecordcount">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getorientrecordcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CalcephBin.getorientrecordcount" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of orientation's records</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the number of orientation's records available in the ephemeris file <em>self</em>.
Usually, the number of records is equal to the number of bodies in the ephemeris file if the timespan is continuous.
If the timespan is discontinuous for the target body,
then each different timespan is counted as a different record.</p>
<p>The following example prints the number of orientation's records available in the ephemeris file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">);</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getorientrecordcount</span><span class="p">()</span>
<span class="n">printf</span><span class="p">(</span><span class="s1">&#39;number of orientation&#39;&#39;s record=</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-getorientrecordindex">
<h3>CalcephBin.getorientrecordindex<a class="headerlink" href="#menu-calceph-getorientrecordindex" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt id="CalcephBin.getorientrecordindex">
<code class="sig-prename descclassname">CalcephBin.</code><code class="sig-name descname">getorientrecordindex</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span> &#x2192; target, firsttime, lasttime, frame<a class="headerlink" href="#CalcephBin.getorientrecordindex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) -- index of the orientation's record, between 1 and <a class="reference internal" href="#CalcephBin.getorientrecordcount" title="CalcephBin.getorientrecordcount"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.getorientrecordcount()</span></code></a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><div class="line-block">
<div class="line"><strong>target</strong> : the target body</div>
<div class="line"><strong>center</strong> : the origin body</div>
<div class="line"><strong>firsttime</strong> : julian date of the first time</div>
<div class="line"><strong>lasttime</strong> : julian date of the last time</div>
<div class="line"><strong>frame</strong>  : reference frame (see the list, below)</div>
</div>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int, double, double, int</p>
</dd>
</dl>
</dd></dl>

<p>This function returns the target body, the first and last time, and the reference frame available at the specified index for the orientation's records of the ephemeris file <em>self</em>.
The NAIF identification numbering system is used for the target body (<a class="reference internal" href="calceph.naifid.html#naif-identification-numbers"><span class="std std-ref">NAIF identification numbers</span></a> for the list).
The Julian date for the first and last time are expressed in the time scale returned by <a class="reference internal" href="#CalcephBin.gettimescale" title="CalcephBin.gettimescale"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">CalcephBin.gettimescale()</span></code></a>.</p>
<p>It returns the following value in the parameter <em>frame</em> :</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>value</p></th>
<th class="head"><p>Name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>ICRF</p></td>
</tr>
</tbody>
</table>
<p>The following example displays the orientation's records stored in the ephemeris file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peph</span> <span class="o">=</span> <span class="n">CalcephBin</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;example1.dat&#39;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getorientrecordcount</span><span class="p">()</span>
<span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
    <span class="p">[</span><span class="n">itarget</span><span class="p">,</span> <span class="n">firsttime</span><span class="p">,</span> <span class="n">lasttime</span><span class="p">,</span> <span class="n">iframe</span><span class="p">]</span> <span class="o">=</span> <span class="n">peph</span><span class="o">.</span><span class="n">getorientrecordindex</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="n">end</span>

<span class="n">peph</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="menu-calceph-close">
<h3>CalcephBin.close<a class="headerlink" href="#menu-calceph-close" title="Permalink to this headline">¶</a></h3>
<dl class="mat method">
<dt>
<code class="sig-prename descclassname">calcephpy.CalcephBin.</code><code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<p>This function closes the access associated to the ephemeris descriptor and frees allocated memory for it.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="calceph.error.html" class="btn btn-neutral float-right" title="Error functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="calceph.interface.html" class="btn btn-neutral float-left" title="Library interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, CNRS, Observatoire de Paris, Observatoire de la Côte d&#39;Azur

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>