.. _objects:

Objects
=======

Objects in |service_name| represent **samples**, **measurements** or **simulations**. They store their metadata, allow users to track their life cycle and provide easy access to related objects, like measurements performed on a sample.

To create an object, users can select an :ref:`Action <actions>` and click on the button labeled **Create Sample**, **Perform Measurement** or **Perform Simulation**.

.. figure:: ../static/img/generated/action.png
    :scale: 50 %
    :alt: Sample Creation using an Example Action and Instrument

    Sample Creation using an Example Action and Instrument

Alternatively, an existing object can be used as a template for new objects, copying its metadata.

Upon its creation, each object in |service_name| is assigned a unique integral ID. While users can use text based names to quickly identify an object, only its ID will be used internally.

Metadata
--------

Each object has a set of metadata, specific to the way the object was created. A sample created using one instrument may have completely different relevant information than a measurement performed on it with another. As such, each :ref:`Action <actions>` has a so-called schema that defines what metadata should be stored for objects created with it.

In general, users will need to enter the information required to reproduce what they did. For more information on metadata, see :ref:`Action Metadata <metadata>`.

.. _tags:

Tags
````

Tags or Keywords serve as a means to organize objects using short, lower case words. A tag may consist of characters *a* to *z* (including *ä*, *ö*, *ü* and *ß*), digits *0* to *9*, *-* and *_*. When entering tags, previously used tags will be suggested to the users to encourage a common tag vocabulary without restricting users.


.. figure:: ../static/img/generated/tags.png
    :scale: 50 %
    :alt: Tags in the Object Metadata

    Tags in the Object Metadata

.. _hazards:

Hazards
```````

Samples which pose hazards to human health or the environment should be labelled using the `Globally Harmonized System of Classification and Labelling (GHS) <https://www.unece.org/trans/danger/publi/ghs/ghs_welcome_e.html>`_. For actions used to creating such samples, these hazards can be part of the object metadata and can be set during object creation or modification.


.. figure:: ../static/img/generated/hazards_input.png
    :scale: 50 %
    :alt: Input of GHS Hazards during Sample Creation

    Input of GHS Hazards during Sample Creation

Versioning
``````````

Once an object has been created, changes to its metadata will be versioned in |service_name|. Users can edit the object using the **Edit Object** button, and once they save their changes, a new version of the object will be stored internally. Although only the latest version is shown by default, users can view older versions from the :ref:`Activity Log <activity_log>`. If a change has been made erroneously, users can restore a previous version without any changes being lost.

Files
-----

Users can upload files related to the object, like sketches or notes generated by measuring software. As |service_name| only serves as a database for metadata, storage is limited and this function is **not** for uploading large datasets or measurement results. For those, a user could leave a :ref:`Comment <comments>` containing the files' path on an archival storage system, for example.

At this time, files can either be uploaded directly from the browser or from a smartphone or other mobile device by scanning a QR code. To upload a file click **Browse** and select either **Local Files** or **Smartphone**.

.. figure:: ../static/img/generated/files.png
    :scale: 50 %
    :alt: Files

    Files

File Information
````````````````

Users can view additional information on a file by clicking on the **i** icon on the right side of the file table. There they can edit a file's title and description, view its history and hide it.

Due to its nature as an archive, files uploaded to |service_name| cannot be deleted. If, however, a wrong file was uploaded accidentally or for some other reason a file's content should be hidden, clicking the **Hide** button will allow users to hide a file. It will not be deleted, but regular users will be unable to access it afterwards.

.. figure:: ../static/img/generated/file_information.png
    :scale: 50 %
    :alt: File Information

    File Information

.. _comments:

Comments
--------

Users can leave comments on objects as free form text, e.g. to share additional information that does not fit the predefined metadata fields. These comments are displayed chronologically on the object's page and will be included in data exports.

.. figure:: ../static/img/generated/comments.png
    :scale: 50 %
    :alt: Comments

    Comments

.. _activity_log:

Activity Log
------------

The activity log shows a timeline of the object's life cycle, containing events like its creation, file uploads and when it was used for another object.

.. figure:: ../static/img/generated/activity_log.png
    :scale: 50 %
    :alt: Activity Log

    Activity Log

.. _locations:

Location
--------

To indicate where a sample is stored, a location and/or a responsible user can be assigned to it. When a user is assigned responsibility for an object, they can confirm this either on the object's page or using the :ref:`Notification <notifications>` they received for the assignment.

The location log shows where an object has been stored and when it was moved.

.. figure:: ../static/img/generated/locations.png
    :scale: 50 %
    :alt: Location

    Location

.. _permissions:

Permissions
-----------

By default, samples, measurements and simulations are visible only to the user who created them and to the instrument scientists of the instrument the objects were created with. Additionally, administrators of |service_name| have access to the database the information is stored in. Object permissions can be used to share access to these objects with other :ref:`users`, :ref:`groups` or :ref:`projects`.

The object permissions built into |service_name| fall into three categories:

- **Read**: The permission to **view objects** and their properties, files and comments.
- **Write**: The permission to **edit objects** and their properties and add files and comments.
- **Grant**: The permission to **grant permissions** to other users.

Each of these categories is built on top of the other, with **Write** permissions including **Read** permissions and **Grant** permissions including **Write** permissions.

.. figure:: ../static/img/generated/object_permissions.png
    :scale: 50 %
    :alt: Object Permissions

    Object Permissions

To modify the permissions of an object, any user with **Grant** permissions can click the **Edit permissions** button on the object's page. They can then view the existing permissions, modify them or add new permissions for users, groups or projects.

Although administrators are shown to have **Grant** permissions for all objects, this only reflects their access to the database mentioned above. At this time, administrators do not automatically have **Grant** permissions for all objects.

.. _default_permissions:

Default Permissions
```````````````````

When an object is created, its creator, any associated instrument scientists and the administrators will have **Grant** permissions. They can then allow other users to access the data by granting them permissions. To make this more convenient, each user has a set of **default permissions** in the :ref:`preferences`, which will be applied to all objects they create in the future.

.. figure:: ../static/img/generated/default_permissions.png
    :scale: 50 %
    :alt: Default Permissions

    Default Permissions in the User Preferences

.. _pdf_export:

Data Export
-----------

Users can export object information to a PDF file, e.g. for printing or offline usage. Note that the exported object information will not be fully complete, e.g. only files of some formats will be included in the PDF and only the current metadata version will be shown.

Alternatively, users can export object information as an archive, which contains the full object information as a JSON file and all files uploaded for the object.

Along with the current object, related objects can be exported along with it, e.g. a sample can be exported together with all measurements performed with it.

Users can also export information for all objects which the user has **READ** permissions for (see :ref:`export`).

Labels
------

|service_name| can be used to create labels for newly created samples. These labels will contain the object's ID, name, creator and creation date, along with :ref:`hazards` if those were specified as part of the object's metadata.

.. note::
    If you require a label format that isn't covered by the ones generated at this time, please `let us know`_.

.. figure:: ../static/img/generated/labels.png
    :scale: 50 %
    :alt: Generated Labels

    Generated Labels

Search
------

Users can find objects using the iffSample search. There are two modes for the object search:

- A *simple* text-based search, and
- an *advanced* search using property comparisons

Simple Search
`````````````

To use the simple search, users can enter words or phrases into the search field and will find all objects containing these.


.. _advanced_search:

Advanced Search
```````````````

The advanced search allows a more fine grained search by performing comparisons on objects' properties and supporting Boolean algebra. Users can enter a query into the search field and select 'Advanced Search' in the adjacent dropdown, though using operators like ``=`` will automatically enable the advanced search mode. Another way to perform an advanced search is by clicking on the search icon next to an object's property that will search for other objects having the same value.

.. figure:: ../static/img/generated/advanced_search_by_property.png
    :scale: 50 %
    :alt: Search button for finding objects with an equal property

    Search button for finding objects with an equal property

When an advanced search is used, |service_name| will show the search tree that the query has been parsed into, to clearly show which filters were used.

.. figure:: ../static/img/generated/advanced_search_visualization.png
    :scale: 50 %
    :alt: Advanced search tree for the query '"Sb" in substance and (temperature < 110degC or temperature > 120degC)'

    Advanced search tree for the query ``"Sb" in substance and (temperature < 110degC or temperature > 120degC)``

Property Names
^^^^^^^^^^^^^^

To search for objects which have property fulfulling some condition, the internal name of that property must be known. Property names are set in an action's schema and the easiest way to find a property is to use the search button shown above. When searching for properties inside an object or array, dots are used as separators and a question mark can be used as wildcard for an array index, e.g. ``layers.?.name == "Base Layer"``.

Boolean operators
^^^^^^^^^^^^^^^^^

Boolean properties or comparisons of other properties can be combined with the boolean operators ``and``, ``or`` and ``not``. ``not`` is first in the order of operations, followed by ``and`` and ``or``. For a different order, parentheses can be used.

Text comparisons
^^^^^^^^^^^^^^^^

Text properties can currently by used either for direct comparisons, e.g. ``name = "Sample"``, or by checking whether a property contains a text, e.g. ``"MBE" in name``.

Quantity comparisons
^^^^^^^^^^^^^^^^^^^^

Quantity properties can be compared using the basic mathematical comparison operators ``<``, ``<=``, ``>``, ``>=``, ``=`` and ``!=``. Comparisons will be performed in the quantities' base units.

Date comparisons
^^^^^^^^^^^^^^^^

Datetime properties can be compared using the basic mathematical comparison operators or the operators ``before``, ``after`` and ``on``. Dates to compare with must be entered using the format ``YYYY-MM-DD``.

Tag search
^^^^^^^^^^

Objects with certain tags can be found using ``#`` and the name of the tag, e.g. ``#hbs``.
