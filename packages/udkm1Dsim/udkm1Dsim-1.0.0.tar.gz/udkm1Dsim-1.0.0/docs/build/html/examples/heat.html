

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Heat &mdash; udkm1Dsim 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Phonons" href="phonons.html" />
    <link rel="prev" title="Structure" href="structure.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> udkm1Dsim
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://github.com/dschick/udkm1Dsim">Project Page</a></li>
<li class="toctree-l1"><a class="reference external" href="http://pypi.python.org/pypi/udkm1Dsim">Download from PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="structure.html">Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="structure.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="structure.html#Atoms">Atoms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="structure.html#Atom">Atom</a></li>
<li class="toctree-l4"><a class="reference internal" href="structure.html#Mixed-Atom">Mixed Atom</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="structure.html#Layers">Layers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="structure.html#Amorphous-Layers">Amorphous Layers</a></li>
<li class="toctree-l4"><a class="reference internal" href="structure.html#Unit-Cells">Unit Cells</a><ul>
<li class="toctree-l5"><a class="reference internal" href="structure.html#Non-Linear-Strain-Dependence">Non-Linear Strain Dependence</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="structure.html#id1">Structure</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Heat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Initialize-Heat">Initialize Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Simple-Excitation">Simple Excitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Laser-Absorption-Profile">Laser Absorption Profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Temperature-Map">Temperature Map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Heat-Diffusion">Heat Diffusion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Heat-Diffusion-Paramters">Heat Diffusion Paramters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Multipulse-Excitation">Multipulse Excitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#N-Temperature-Model">N-Temperature Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="phonons.html">Phonons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="phonons.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="phonons.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="phonons.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="phonons.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="phonons.html#Anharmonic-Phonon-Propagation">Anharmonic Phonon Propagation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dynamical_xray.html">Dynamical Xray Scattering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Initialize-dynamical-X-ray-simulation">Initialize dynamical X-ray simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Homogeneous-X-ray-scattering">Homogeneous X-ray scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dynamical_xray.html#q_z-scan"><span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamical_xray.html#Post-Processing">Post-Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamical_xray.html#Energy-scan">Energy-scan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Inhomogeneous-X-ray-scattering">Inhomogeneous X-ray scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_xray.html#Parallel-inhomogeneous-X-ray-scattering">Parallel inhomogeneous X-ray scattering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dynamical_magnetic_xray.html">Dynamical Magnetic Xray Scattering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Heat">Heat</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Numerical-Phonons">Numerical Phonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Magnetization">Magnetization</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Initialize-dynamical-magnetic-X-ray-simulations">Initialize dynamical magnetic X-ray simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Homogeneous-magnetic-X-ray-scattering">Homogeneous magnetic X-ray scattering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dynamical_magnetic_xray.html#q_z-scan"><span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamical_magnetic_xray.html#Post-Processing">Post-Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamical_magnetic_xray.html#Energy--and-q_z-scan">Energy- and <span class="math notranslate nohighlight">\(q_z\)</span>-scan</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamical_magnetic_xray.html#Polarization-dependence">Polarization dependence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Inhomogeneous-dynamical-magnetic-X-ray-scattering">Inhomogeneous dynamical magnetic X-ray scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamical_magnetic_xray.html#Parallel-dynamical-Xray-scattering">Parallel dynamical Xray scattering</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../atoms.html"><code class="docutils literal notranslate"><span class="pre">structures.atoms</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../layers.html"><code class="docutils literal notranslate"><span class="pre">structures.layers</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure.html"><code class="docutils literal notranslate"><span class="pre">structures.structure</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulation.html"><code class="docutils literal notranslate"><span class="pre">simulations.simulation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../heat.html"><code class="docutils literal notranslate"><span class="pre">simulations.heat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../phonons.html"><code class="docutils literal notranslate"><span class="pre">simulations.phonons</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../magnetization.html"><code class="docutils literal notranslate"><span class="pre">simulations.magnetization</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../xrays.html"><code class="docutils literal notranslate"><span class="pre">simulations.xrays</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers.html"><code class="docutils literal notranslate"><span class="pre">helpers</span></code></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">udkm1Dsim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Heat</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/heat.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Heat">
<h1>Heat<a class="headerlink" href="#Heat" title="Permalink to this headline">¶</a></h1>
<p>In this example the laser-excitation of a sample <code class="docutils literal notranslate"><span class="pre">Structure</span></code> is shown. It includes the actual absorption of the laser light as well as the transient temperature profile calculation.</p>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>Do all necessary imports and settings.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">udkm1Dsim</span> <span class="k">as</span> <span class="nn">ud</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">u</span> <span class="c1">#  import the pint unit registry from udkm1Dsim</span>
<span class="kn">import</span> <span class="nn">scipy.constants</span> <span class="k">as</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">u</span><span class="o">.</span><span class="n">setup_matplotlib</span><span class="p">()</span> <span class="c1">#  use matplotlib with pint units</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Structure">
<h2>Structure<a class="headerlink" href="#Structure" title="Permalink to this headline">¶</a></h2>
<p>Refere to the <a class="reference internal" href="structure.html"><span class="doc">structure-example</span></a> for more details.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">O</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="n">Ti</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Ti&#39;</span><span class="p">)</span>
<span class="n">Sr</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Sr&#39;</span><span class="p">)</span>
<span class="n">Ru</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Ru&#39;</span><span class="p">)</span>
<span class="n">Pb</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Pb&#39;</span><span class="p">)</span>
<span class="n">Zr</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="s1">&#39;Zr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># c-axis lattice constants of the two layers</span>
<span class="n">c_STO_sub</span> <span class="o">=</span> <span class="mf">3.905</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">angstrom</span>
<span class="n">c_SRO</span> <span class="o">=</span> <span class="mf">3.94897</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">angstrom</span>
<span class="c1"># sound velocities [nm/ps] of the two layers</span>
<span class="n">sv_SRO</span> <span class="o">=</span> <span class="mf">6.312</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span>
<span class="n">sv_STO</span> <span class="o">=</span> <span class="mf">7.800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span>

<span class="c1"># SRO layer</span>
<span class="n">prop_SRO</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;a_axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_STO_sub</span> <span class="c1"># aAxis</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;b_axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_STO_sub</span> <span class="c1"># bAxis</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;deb_Wal_Fac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Debye-Waller factor</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;sound_vel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv_SRO</span> <span class="c1"># sound velocity</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;opt_ref_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.44</span><span class="o">+</span><span class="mf">4.32</span><span class="n">j</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;therm_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.72</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span> <span class="c1"># heat conductivity</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;lin_therm_exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.03e-5</span> <span class="c1"># linear thermal expansion</span>
<span class="n">prop_SRO</span><span class="p">[</span><span class="s1">&#39;heat_capacity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lambda T: 455.2 + 0.112*T - 2.1935e6/T**2&#39;</span> <span class="c1"># heat capacity [J/kg K]</span>

<span class="n">SRO</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">UnitCell</span><span class="p">(</span><span class="s1">&#39;SRO&#39;</span><span class="p">,</span> <span class="s1">&#39;Strontium Ruthenate&#39;</span><span class="p">,</span> <span class="n">c_SRO</span><span class="p">,</span> <span class="o">**</span><span class="n">prop_SRO</span><span class="p">)</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Sr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Ru</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># STO substrate</span>
<span class="n">prop_STO_sub</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;a_axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_STO_sub</span> <span class="c1"># aAxis</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;b_axis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_STO_sub</span> <span class="c1"># bAxis</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;deb_Wal_Fac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Debye-Waller factor</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;sound_vel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv_STO</span> <span class="c1"># sound velocity</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;opt_ref_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;therm_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span> <span class="c1"># heat conductivity</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;lin_therm_exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="c1"># linear thermal expansion</span>
<span class="n">prop_STO_sub</span><span class="p">[</span><span class="s1">&#39;heat_capacity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lambda T: 733.73 + 0.0248*T - 6.531e6/T**2&#39;</span> <span class="c1"># heat capacity [J/kg K]</span>

<span class="n">STO_sub</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">UnitCell</span><span class="p">(</span><span class="s1">&#39;STOsub&#39;</span><span class="p">,</span> <span class="s1">&#39;Strontium Titanate Substrate&#39;</span><span class="p">,</span> <span class="n">c_STO_sub</span><span class="p">,</span> <span class="o">**</span><span class="n">prop_STO_sub</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Sr</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">Ti</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;Single Layer&#39;</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_sub_structure</span><span class="p">(</span><span class="n">SRO</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># add 100 layers of SRO to sample</span>
<span class="n">S</span><span class="o">.</span><span class="n">add_sub_structure</span><span class="p">(</span><span class="n">STO_sub</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="c1"># add 200 layers of STO substrate</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Initialize-Heat">
<h2>Initialize Heat<a class="headerlink" href="#Initialize-Heat" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Heat</span></code> class requires a <code class="docutils literal notranslate"><span class="pre">Structure</span></code> object and a boolean <code class="docutils literal notranslate"><span class="pre">force_recalc</span></code> in order overwrite previous simulation results.</p>
<p>These results are saved in the <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code> when <code class="docutils literal notranslate"><span class="pre">save_data</span></code> is enabled. Printing simulation messages can be en-/disabled using <code class="docutils literal notranslate"><span class="pre">disp_messages</span></code> and progress bars can using the boolean switch <code class="docutils literal notranslate"><span class="pre">progress_bar</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span> <span class="o">=</span> <span class="n">ud</span><span class="o">.</span><span class="n">Heat</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">h</span><span class="o">.</span><span class="n">save_data</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">h</span><span class="o">.</span><span class="n">disp_messages</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Heat simulation properties:

This is the current structure for the simulations:

Structure properties:

Name   : Single Layer
Thickness : 117.59 nanometer
Roughness : 0.00 nanometer
----
100 times Strontium Ruthenate: 39.49 nanometer
200 times Strontium Titanate Substrate: 78.10 nanometer
----
no substrate


Display properties:

================================  =======================================================
                       parameter  value
================================  =======================================================
                    force recalc  True
                 cache directory  ./
                display messages  True
                       save data  False
                    progress bar  True
              excitation fluence  [] mJ/cm²
                excitation delay  [0.0] ps
         excitation pulse length  [0.0] ps
           excitation wavelength  799.9999999999999 nm
                excitation theta  90.0 deg
excitation multilayer absorption  True
                  heat diffusion  False
       interpolate at interfaces  11
                         backend  scipy
                       distances  no distance mesh is set for heat diffusion calculations
               top boundary type  isolator
            bottom boundary type  isolator
================================  =======================================================
</pre></div></div>
</div>
</div>
<div class="section" id="Simple-Excitation">
<h2>Simple Excitation<a class="headerlink" href="#Simple-Excitation" title="Permalink to this headline">¶</a></h2>
<p>In order to calculate the temperature of the sample after quasi-instantanious (delta) photoexcitation the <code class="docutils literal notranslate"><span class="pre">excitation</span></code> must be set with the following parameters: * <code class="docutils literal notranslate"><span class="pre">fluence</span></code> * <code class="docutils literal notranslate"><span class="pre">delay_pump</span></code> * <code class="docutils literal notranslate"><span class="pre">pulse_width</span></code> * <code class="docutils literal notranslate"><span class="pre">multilayer_absorption</span></code> * <code class="docutils literal notranslate"><span class="pre">wavelength</span></code> * <code class="docutils literal notranslate"><span class="pre">theta</span></code></p>
<div class="line-block">
<div class="line">The <code class="docutils literal notranslate"><span class="pre">wavelength</span></code> and <code class="docutils literal notranslate"><span class="pre">theta</span></code> angle of the excitation are only relevant if <code class="docutils literal notranslate"><span class="pre">multilayer_absorption</span> <span class="pre">=</span> <span class="pre">True</span></code>. Otherwise the <em>Lambert_Beer</em>-law is used.</div>
<div class="line"><strong>Note:</strong> the <code class="docutils literal notranslate"><span class="pre">fluence</span></code>, <code class="docutils literal notranslate"><span class="pre">delay_pump</span></code>, and <code class="docutils literal notranslate"><span class="pre">pulse_width</span></code> must be given as <code class="docutils literal notranslate"><span class="pre">array</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code>.</div>
</div>
<p>The simulation requires also a <code class="docutils literal notranslate"><span class="pre">delay</span></code> array as temporal grid as well as an initial temperature <code class="docutils literal notranslate"><span class="pre">init_temp</span></code>. The later can be either a scalar which is then the constant temperature of the whole sample structure, or the initial temperature can be an array of temperatures for each single layer in the structure.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">excitation</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fluence&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mJ</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;delay_pump&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;pulse_width&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;multilayer_absorption&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span>
                <span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">}</span>

<span class="c1"># when calculating the laser absorption profile using Lamber-Beer-law</span>
<span class="c1"># the opt_pen_depth must be set manually or calculated from the refractive index</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">set_opt_pen_depth_from_ref_index</span><span class="p">(</span><span class="mi">800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">set_opt_pen_depth_from_ref_index</span><span class="p">(</span><span class="mi">800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>

<span class="c1"># temporal and spatial grid</span>
<span class="n">delays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="mi">200</span><span class="p">:</span><span class="mf">0.1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">get_distances_of_layers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\schick\general\python\wpy64-3770\python-3.7.7.amd64\lib\site-packages\pint\quantity.py:1138: RuntimeWarning: divide by zero encountered in double_scalars
  magnitude = magnitude_op(self._magnitude, other_magnitude)
</pre></div></div>
</div>
<div class="section" id="Laser-Absorption-Profile">
<h3>Laser Absorption Profile<a class="headerlink" href="#Laser-Absorption-Profile" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Here the difference in the spatial laser absorption profile is shown between the multilayer absorption algorithm and the Lamber-Beer law.</div>
<div class="line">Note that Lambert-Beer does not include reflection of the incident light from the surface of the sample structure:</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">dAdz</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_multilayers_absorption_profile</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">),</span> <span class="n">dAdz</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;multilayer&#39;</span><span class="p">)</span>
<span class="n">dAdz</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_Lambert_Beer_absorption_profile</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">),</span> <span class="n">dAdz</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lamber-Beer&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Differnetial Absorption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laser Absorption Profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_12_0.png" src="../_images/examples_heat_12_0.png" />
</div>
</div>
</div>
<div class="section" id="Temperature-Map">
<h3>Temperature Map<a class="headerlink" href="#Temperature-Map" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">temp_map</span><span class="p">,</span> <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_temp_map</span><span class="p">(</span><span class="n">delays</span><span class="p">,</span> <span class="mi">300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Elapsed time for _temperature_after_delta_excitation_: 0.015956 s
Elapsed time for _temp_map_: 0.087948 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Profile&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_15_0.png" src="../_images/examples_heat_15_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Heat-Diffusion">
<h2>Heat Diffusion<a class="headerlink" href="#Heat-Diffusion" title="Permalink to this headline">¶</a></h2>
<p>In order to enable heat diffusion the boolean switch <code class="docutils literal notranslate"><span class="pre">heat_diffusion</span></code> must be <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># enable heat diffusion</span>
<span class="n">h</span><span class="o">.</span><span class="n">heat_diffusion</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># set the boundary conditions</span>
<span class="n">h</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">}</span>
<span class="c1"># The resulting temperature profile is calculated in one line:</span>
<span class="n">temp_map</span><span class="p">,</span> <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_temp_map</span><span class="p">(</span><span class="n">delays</span><span class="p">,</span> <span class="mi">300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Elapsed time for _temperature_after_delta_excitation_: 0.014962 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c4c8de98d8fa4703a1ffab934aedc700", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 6.501284 s
Elapsed time for _temp_map_: 6.611260 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">101</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">501</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">501</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Profile with Heat Diffusion&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map with Heat Diffusion&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_18_0.png" src="../_images/examples_heat_18_0.png" />
</div>
</div>
<div class="section" id="Heat-Diffusion-Paramters">
<h3>Heat Diffusion Paramters<a class="headerlink" href="#Heat-Diffusion-Paramters" title="Permalink to this headline">¶</a></h3>
<p>For heat diffusion simulations various parameters for the underlying pdepe solver can be altered.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">backend</span></code> is set to <code class="docutils literal notranslate"><span class="pre">scipy</span></code> but can be switched to <code class="docutils literal notranslate"><span class="pre">matlab</span></code>. Currently, the is no obvious reason to choose <em>MATLAB</em> above <em>SciPy</em>.</p>
<p>Depending on the <code class="docutils literal notranslate"><span class="pre">backend</span></code> either the <code class="docutils literal notranslate"><span class="pre">ode_options</span></code> or <code class="docutils literal notranslate"><span class="pre">ode_options_matlab</span></code> can be configured and are directly handed to the actual solver. Please refere to the documentation of the actual backend and solver and the <strong>API documentation</strong> for more details.</p>
<p>The speed but also the result of the heat diffusion simulation strongly depends on the spatial grid handed to the solver. By default, one spatial grid point is used for every <code class="docutils literal notranslate"><span class="pre">Layer</span></code> (<code class="docutils literal notranslate"><span class="pre">AmorphousLayer</span></code> or <code class="docutils literal notranslate"><span class="pre">UnitCell</span></code>) in the <code class="docutils literal notranslate"><span class="pre">Structure</span></code>. The resulting <code class="docutils literal notranslate"><span class="pre">temp_map</span></code> will also always be interpolated in this spatial grid which is equivalent to the distance vector returned by <code class="docutils literal notranslate"><span class="pre">S.get_distances_of_layers()</span></code>.</p>
<p>As the solver for the heat diffusion usually suffers from large gradients, e.g. of thermal properties or initial temperatures, additional spatial grid points are added by default only for internal calculations. The number of additional points (should be an odd number, default is 11) is set by:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">intp_at_interface</span> <span class="o">=</span> <span class="mi">11</span>
</pre></div>
</div>
</div>
<p>The internally used spatial grid can be returned by:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dist_interp</span><span class="p">,</span> <span class="n">original_indicies</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">interp_distance_at_interfaces</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">intp_at_interface</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The internal spatial grid can also be given by hand, e.g. to realize logarithmic steps for rather large <code class="docutils literal notranslate"><span class="pre">Structure</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">magnitude</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">m</span>
</pre></div>
</div>
</div>
<p>As already shown above, the heat diffusion simulation supports also an top and bottom boundary condition. The can have the types: * <code class="docutils literal notranslate"><span class="pre">isolator</span></code> * <code class="docutils literal notranslate"><span class="pre">temperature</span></code> * <code class="docutils literal notranslate"><span class="pre">flux</span></code></p>
<p>For the later types also a value must be provides:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top_type&#39;</span><span class="p">:</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;top_value&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">,</span>
                         <span class="s1">&#39;bottom_type&#39;</span><span class="p">:</span> <span class="s1">&#39;flux&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom_value&#39;</span><span class="p">:</span> <span class="mf">5e11</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Heat simulation properties:

This is the current structure for the simulations:

Structure properties:

Name   : Single Layer
Thickness : 117.59 nanometer
Roughness : 0.00 nanometer
----
100 times Strontium Ruthenate: 39.49 nanometer
200 times Strontium Titanate Substrate: 78.10 nanometer
----
no substrate


Display properties:

================================  =======================================================
                       parameter  value
================================  =======================================================
                    force recalc  True
                 cache directory  ./
                display messages  True
                       save data  False
                    progress bar  True
              excitation fluence  [5.0] mJ/cm²
                excitation delay  [0.0] ps
         excitation pulse length  [0.0] ps
           excitation wavelength  800.0 nm
                excitation theta  45.0 deg
excitation multilayer absorption  True
                  heat diffusion  True
       interpolate at interfaces  11
                         backend  scipy
                       distances  a distance mesh is set for heat diffusion calculations.
               top boundary type  temperature
        top boundary temperature  500 K
            bottom boundary type  flux
            bottom boundary flux  500000000000.0 W/m²
================================  =======================================================
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The resulting temperature profile is calculated in one line:</span>
<span class="n">temp_map</span><span class="p">,</span> <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_temp_map</span><span class="p">(</span><span class="n">delays</span><span class="p">,</span> <span class="mi">300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8d2688314b2641c187a05558bebd50f3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 0.791059 s
Elapsed time for _temperature_after_delta_excitation_: 0.006981 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3e749e60e6d84b39a6dd416b2f68fb1d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 0.979264 s
Elapsed time for _temp_map_: 1.830167 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">101</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">501</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">501</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Profile with Heat Diffusion and BC&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map with Heat Diffusion and BC&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_28_0.png" src="../_images/examples_heat_28_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Multipulse-Excitation">
<h2>Multipulse Excitation<a class="headerlink" href="#Multipulse-Excitation" title="Permalink to this headline">¶</a></h2>
<p>As already stated above, also multiple pulses of variable fluence, pulse width and, delay are possible.</p>
<p>The heat diffusion simulation automatically splits the calculation in parts with and without excitation and adjusts the initial temporal step width according to the pulse width. Hence the solver does not miss any excitation pulses when adjusting its temporal step size.</p>
<p>The temporal laser pulse profile is always assumed to be gaussian and the pulse width must be given as FWHM:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">excitation</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fluence&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mJ</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;delay_pump&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;pulse_width&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;multilayer_absorption&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span>
                <span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">}</span>

<span class="n">h</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The resulting temperature profile is calculated in one line:</span>
<span class="n">temp_map</span><span class="p">,</span> <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_temp_map</span><span class="p">(</span><span class="n">delays</span><span class="p">,</span> <span class="mi">300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating _heat_diffusion_ for excitation 1:1 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c9b019601c2a4b1588ec43f62b57e7fb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_ with 1 excitation(s): 0.848871 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d41448c62c9a46f0b130266783e362f8", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 0.648266 s
Calculating _heat_diffusion_ for excitation 2:2 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "41eb6b5a4ede4ae099bea181a84008ea", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_ with 1 excitation(s): 0.613387 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cb72b8a7ea3b42b2813460ba12afce58", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 0.519606 s
Calculating _heat_diffusion_ for excitation 3:3 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a8b1568159a64c7b8f6ab704b586387f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_ with 1 excitation(s): 0.543585 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4a4078517f8f4595b1c9b5fd77bff4c1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 0.692392 s
Elapsed time for _temp_map_: 4.025329 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">101</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">201</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">201</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="mi">301</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="mi">301</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">delays</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Profile Multiplulse&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map Multiplulse&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_32_0.png" src="../_images/examples_heat_32_0.png" />
</div>
</div>
</div>
<div class="section" id="N-Temperature-Model">
<h2>N-Temperature Model<a class="headerlink" href="#N-Temperature-Model" title="Permalink to this headline">¶</a></h2>
<p>The heat diffusion is also capable of simulating an <em>N</em>-temperature model which is often applied to empirically simulate the energy flow between <em>electrons</em>, <em>phonons</em>, and <em>spins</em>. In order to run the <em>NTM</em> all thermo-elastic properties must be given as a list of <em>N</em> elements. In addition the <code class="docutils literal notranslate"><span class="pre">sub_system_coupling</span></code> must be provided in order to allow for energy-flow between the sub-systems. The actual external laser-excitation is always set to happen within the <strong>first</strong> sub-system, which is
usually the <em>electron</em>-system.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># update the relevant thermo-elastic properties of the layers in the sample structure</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">therm_cond</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                  <span class="mf">5.72</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)]</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">lin_therm_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.03e-5</span><span class="p">,</span>
                     <span class="mf">1.03e-5</span><span class="p">]</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">heat_capacity</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lambda T: 0.112*T&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;lambda T: 455.2 - 2.1935e6/T**2&#39;</span><span class="p">]</span>
<span class="n">SRO</span><span class="o">.</span><span class="n">sub_system_coupling</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lambda T: 5e17*(T[1]-T[0])&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;lambda T: 5e17*(T[0]-T[1])&#39;</span><span class="p">]</span>

<span class="n">STO_sub</span><span class="o">.</span><span class="n">therm_cond</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                      <span class="mi">12</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)]</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">lin_therm_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span>
                         <span class="mf">1e-5</span><span class="p">]</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">heat_capacity</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lambda T: 0.0248*T&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;lambda T: 733.73 - 6.531e6/T**2&#39;</span><span class="p">]</span>
<span class="n">STO_sub</span><span class="o">.</span><span class="n">sub_system_coupling</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lambda T: 5e17*(T[1]-T[0])&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;lambda T: 5e17*(T[0]-T[1])&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>As no new <code class="docutils literal notranslate"><span class="pre">Structure</span></code> is build, the <code class="docutils literal notranslate"><span class="pre">num_sub_systems</span></code> must be updated by hand. Otherwise this happens automatically.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">S</span><span class="o">.</span><span class="n">num_sub_systems</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<p>Set the exciation conditions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">h</span><span class="o">.</span><span class="n">excitation</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fluence&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mJ</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;delay_pump&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;pulse_width&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.25</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span>
                <span class="s1">&#39;multilayer_absorption&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;wavelength&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">nm</span><span class="p">,</span>
                <span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">}</span>

<span class="n">h</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom_type&#39;</span><span class="p">:</span> <span class="s1">&#39;isolator&#39;</span><span class="p">}</span>

<span class="n">delays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">0.01</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">ps</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The resulting temperature profile is calculated in one line:</span>
<span class="n">temp_map</span><span class="p">,</span> <span class="n">delta_temp</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">get_temp_map</span><span class="p">(</span><span class="n">delays</span><span class="p">,</span> <span class="mi">300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating _heat_diffusion_ for excitation 1:1 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2788d4306d334a7b88bc58e1a853e71e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_ with 1 excitation(s): 2.053165 s
Calculating _heat_diffusion_ ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d730ce3266674ee6998b3805fd234192", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Elapsed time for _heat_diffusion_: 2.248610 s
Elapsed time for _temp_map_: 4.445906 s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map Electrons&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">temp_map</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Map Phonons&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_40_0.png" src="../_images/examples_heat_40_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp_map</span><span class="p">[:,</span> <span class="n">S</span><span class="o">.</span><span class="n">get_all_positions_per_unique_layer</span><span class="p">()[</span><span class="s1">&#39;SRO&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SRO electrons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">delays</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp_map</span><span class="p">[:,</span> <span class="n">S</span><span class="o">.</span><span class="n">get_all_positions_per_unique_layer</span><span class="p">()[</span><span class="s1">&#39;SRO&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SRO phonons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [K]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delay [ps]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature Electrons vs. Phonons&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_heat_41_0.png" src="../_images/examples_heat_41_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="phonons.html" class="btn btn-neutral float-right" title="Phonons" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="structure.html" class="btn btn-neutral float-left" title="Structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Daniel Schick

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>